# 테트리스 게임 PRD (Product Requirements Document)

## 1. 프로젝트 개요

### 1.1 목적
클래식 테트리스 게임을 웹 기반으로 구현하여 사용자에게 즐거운 게임 경험을 제공합니다.

### 1.2 목표
- 직관적이고 반응성 좋은 테트리스 게임 구현
- 모바일 및 데스크톱 환경 모두 지원
- 원활한 게임 플레이 경험 제공

## 2. 핵심 기능 요구사항

### 2.1 게임 보드
- **크기**: 10x20 그리드 (가로 10칸, 세로 20칸)
- **블록 렌더링**: 각 셀은 색상으로 구분
- **경계선**: 게임 영역을 명확하게 표시

### 2.2 테트로미노 (게임 블록)
7가지 기본 테트로미노 구현:
- **I-Block** (하늘색): 4칸 일직선
- **O-Block** (노란색): 2x2 정사각형
- **T-Block** (보라색): T자 모양
- **L-Block** (주황색): L자 모양
- **J-Block** (파란색): 역L자 모양
- **S-Block** (초록색): S자 모양
- **Z-Block** (빨간색): Z자 모양

### 2.3 게임 조작
- **좌우 이동**: 화살표 키 (←, →) 또는 A/D 키
- **회전**: 화살표 위 (↑) 또는 W 키 (시계방향)
- **소프트 드롭**: 화살표 아래 (↓) 또는 S 키 (빠른 하강)
- **하드 드롭**: 스페이스바 (즉시 착지)
- **홀드**: C 키 또는 Shift 키
- **힌트**: H 키 (게임당 5회)
- **일시정지**: P 키 또는 ESC 키
- **재시작**: 일시정지 중 R 키

### 2.4 게임 메커니즘
- **자동 낙하**: 블록이 일정 시간마다 한 칸씩 자동으로 하강
- **블록 고정**: 블록이 바닥이나 다른 블록에 닿으면 고정
- **줄 제거**: 가로줄이 완전히 채워지면 해당 줄 제거
- **중력 적용**: 줄이 제거되면 위의 블록들이 아래로 이동
- **게임 오버**: 새 블록이 생성될 공간이 없으면 게임 종료

### 2.5 점수 시스템
- **1줄 제거**: 100점
- **2줄 제거**: 300점
- **3줄 제거**: 500점
- **4줄 제거 (테트리스)**: 800점
- **소프트 드롭**: 낙하한 칸 수만큼 1점
- **하드 드롭**: 낙하한 칸 수의 2배 점수

### 2.6 레벨 시스템
- 10줄 제거마다 레벨 1 증가
- 레벨이 오를수록 블록 낙하 속도 증가
- 낙하 속도 공식: `속도 = 1000ms - (레벨 × 50ms)` (최소 100ms)

### 2.7 다음 블록 미리보기
- 다음에 나올 블록을 별도 영역에 표시
- 최소 1개, 선택적으로 3개까지 미리보기 가능

### 2.8 홀드 기능
- 현재 블록을 저장하고 나중에 사용 가능
- 홀드는 한 블록당 1회만 가능
- 홀드된 블록을 별도 영역에 표시

### 2.9 AI 힌트 시스템
- **사용 횟수**: 게임당 5회 제한
- **동작 방식**: H 키를 눌러 현재 블록의 최적 배치 위치 표시
- **평가 기준**:
  - 줄 완성 가능성 최대화
  - 구멍(빈 공간) 최소화
  - 보드 높이 최소화
  - 평탄도 유지 (높이 차이 최소화)
  - 블록 간 접촉 최대화
- **시각 효과**: 추천 위치를 녹색 반투명으로 3초간 표시
- **UI 표시**: 남은 힌트 횟수를 왼쪽 패널에 표시

### 2.10 줄 제거 효과
- **깜빡임 애니메이션**:
  - 1줄: 흰색
  - 2줄: 노란색
  - 3줄: 주황색
  - 4줄 (테트리스): 빨간색
- **파티클 효과**:
  - 줄 수에 비례하여 파티클 수 증가 (20~80개)
  - 중력 적용된 자연스러운 낙하 애니메이션
  - 4줄 제거 시 무지개색 파티클로 최대 화려함

## 3. UI/UX 요구사항

### 3.1 게임 화면 레이아웃
```
┌─────────────────────────────────┐
│        TETRIS GAME              │
├──────┬──────────────┬───────────┤
│ HOLD │              │   NEXT    │
│      │              │           │
│ [  ] │              │   [  ]    │
│      │   GAME       │   [  ]    │
├──────┤   BOARD      │   [  ]    │
│SCORE │              │           │
│ 1234 │              │           │
│      │              │           │
│LEVEL │              │           │
│  3   │              │           │
│      │              │           │
│LINES │              │           │
│  25  │              │           │
└──────┴──────────────┴───────────┘
```

### 3.2 게임 상태 표시
- **점수 (Score)**: 현재 획득한 점수
- **레벨 (Level)**: 현재 레벨
- **라인 (Lines)**: 제거한 총 줄 수
- **힌트 (Hints)**: 남은 힌트 사용 횟수

### 3.3 게임 시작/종료 화면
- **시작 화면**:
  - 게임 제목, Space로 시작 안내
  - NEXT와 HOLD 영역은 빈 상태로 표시
  - 하단에 조작법 안내
- **일시정지 화면**:
  - 반투명 오버레이
  - "Continue (P)" 버튼: 게임 계속
  - "Restart (R)" 버튼: 게임 재시작
  - 키보드 단축키 안내
- **게임 오버 화면**:
  - 최종 점수, 라인 수, 레벨 표시
  - "Restart (Space)" 버튼

### 3.4 반응형 디자인
- 데스크톱: 1024px 이상 (풀 레이아웃)
- 태블릿: 768px ~ 1023px (중간 레이아웃)
- 모바일: 767px 이하 (세로 스택 레이아웃, 터치 컨트롤)

## 4. 기술 요구사항

### 4.1 기술 스택 (구현 완료)
- **프론트엔드**: HTML5, CSS3, Vanilla JavaScript (ES6+)
- **렌더링**: Canvas API
- **파일 구조**:
  - `index.html`: 메인 HTML 구조
  - `style.css`: 스타일링 및 반응형 디자인
  - `game.js`: 게임 로직 및 AI 알고리즘

### 4.2 성능 요구사항
- **프레임률**: 60 FPS 유지
- **입력 지연**: 16ms 이하
- **초기 로딩**: 3초 이내

### 4.3 브라우저 호환성
- Chrome 최신 버전
- Firefox 최신 버전
- Safari 최신 버전
- Edge 최신 버전

## 5. 추가 기능

### 5.1 고스트 블록 ✅ (구현 완료)
- 현재 블록이 착지할 위치를 반투명으로 표시
- 항상 활성화되어 블록 배치를 돕습니다

### 5.2 사운드/음악 (미구현)
- 블록 회전 소리
- 블록 착지 소리
- 줄 제거 소리
- 배경 음악
- 음소거 옵션

### 5.3 저장 기능 (미구현)
- 로컬 스토리지를 이용한 최고 점수 저장
- 게임 진행 상황 저장

### 5.4 설정 (미구현)
- 난이도 선택 (쉬움/보통/어려움)
- 키 설정 변경
- 색상 테마 변경

### 5.5 통계 (미구현)
- 총 플레이 시간
- 블록별 사용 횟수
- 최고 연속 테트리스 기록

## 6. 개발 우선순위 및 구현 상태

### Phase 1: MVP (필수) ✅ 완료
1. ✅ 기본 게임 보드 렌더링 (Canvas 기반)
2. ✅ 7가지 테트로미노 구현 (모든 회전 상태 포함)
3. ✅ 블록 이동, 회전, 낙하 (Wall Kick 포함)
4. ✅ 줄 제거 로직
5. ✅ 점수 시스템 (소프트/하드 드롭 보너스 포함)
6. ✅ 게임 오버 처리

### Phase 2: 핵심 기능 ✅ 완료
1. ✅ 레벨 시스템 (10줄마다 레벨 업, 속도 증가)
2. ✅ 다음 블록 미리보기 (3개)
3. ✅ 홀드 기능 (C/Shift 키)
4. ✅ 일시정지 기능 (P/ESC 키, 재시작 R 키)
5. ✅ UI 개선 (버튼, 오버레이, 애니메이션)

### Phase 3: 개선 및 확장 🔄 부분 완료
1. ✅ 고스트 블록 (착지 위치 미리보기)
2. ❌ 사운드/음악 (미구현)
3. ❌ 저장 기능 (미구현)
4. ✅ 반응형 디자인 (데스크톱/태블릿/모바일)
5. ❌ 모바일 터치 컨트롤 (미구현)

### Phase 4: 추가 구현된 기능 ✅ 완료
1. ✅ 줄 제거 애니메이션 효과 (깜빡임 + 파티클)
2. ✅ AI 힌트 시스템 (H 키, 게임당 5회)
3. ✅ 향상된 일시정지 메뉴 (버튼 UI)
4. ✅ 게임 시작 전 블록 숨김 처리

## 7. 테스트 요구사항

### 7.1 기능 테스트
- 모든 블록 타입이 정상적으로 생성되는지 확인
- 회전 로직이 모든 블록에서 올바르게 동작하는지 확인
- 벽 킥(Wall Kick) 처리 확인
- 줄 제거가 정확하게 동작하는지 확인
- 점수 계산이 정확한지 확인

### 7.2 엣지 케이스
- 게임 보드 경계에서의 동작
- 동시 여러 줄 제거
- 빠른 연속 입력 처리
- 블록 고정 타이밍

### 7.3 성능 테스트
- 장시간 플레이 시 메모리 누수 확인
- 높은 레벨에서의 성능 확인

## 8. 제약사항

- 외부 라이브러리 사용 최소화
- 오프라인에서도 플레이 가능해야 함
- 파일 크기 최소화 (전체 3MB 이하)

## 9. 성공 지표

- ✅ 게임이 3초 이내에 로드됨
- ✅ 60 FPS로 안정적으로 실행됨
- ✅ 모든 핵심 기능이 버그 없이 동작함
- ✅ 데스크톱과 태블릿에서 플레이 가능함
- 🔄 모바일 터치 컨트롤은 미구현

## 10. 구현 완료 내역 (2025-11-06)

### 완료된 주요 기능
1. **완전한 테트리스 게임 메커니즘**
   - 7가지 테트로미노, 회전, 이동, 충돌 감지
   - Wall Kick, 고스트 블록
   - 점수, 레벨, 라인 카운트

2. **고급 기능**
   - 홀드 시스템
   - 다음 블록 3개 미리보기
   - AI 힌트 시스템 (게임당 5회)

3. **시각 효과**
   - 줄 제거 시 깜빡임 애니메이션
   - 파티클 효과 (줄 수에 따라 다름)
   - 고스트 블록 표시

4. **UI/UX**
   - 반응형 디자인 (데스크톱/태블릿)
   - 일시정지 메뉴 (버튼 포함)
   - 게임 시작 전 블록 숨김

### 실행 방법
```bash
python3 -m http.server 8000
# 브라우저에서 http://localhost:8000 접속
```

### 조작법
- **이동**: ← → 또는 A/D
- **회전**: ↑ 또는 W
- **소프트 드롭**: ↓ 또는 S
- **하드 드롭**: Space
- **홀드**: C 또는 Shift
- **힌트**: H (게임당 5회)
- **일시정지**: P 또는 ESC
- **재시작**: R (일시정지 중)
